/*Compiled by Apdata: 2016-04-29 14:04*/
function translate(){updateDate();Ext.apdata.ScreenUtil.cache.get("indexPage").hide();Ext.apdata.ScreenUtil.cache.get("idioms_lbl").update(Ext.apdata.lang.idioms);Ext.apdata.ScreenUtil.cache.get("username_lbl").update(Ext.apdata.lang.userName);Ext.apdata.ScreenUtil.cache.get("password_lbl").update(Ext.apdata.lang.password);Ext.apdata.ScreenUtil.cache.get("forgotPassword_lbl").update(Ext.apdata.lang.forgotPassword);Ext.apdata.ScreenUtil.cache.get("tituloCxLinksExternos").update(Ext.apdata.lang.externalLinks);Ext.apdata.ScreenUtil.cache.get("welcome_lbl").update(index.bemvindo);Ext.apdata.ScreenUtil.cache.get("txtSaudacao").update(index.saudacao);Ext.apdata.ScreenUtil.cache.get("label_rodape").update(String.format(Ext.apdata.lang.apdataRodape,Ext.apdata.getAnoRopade()));Ext.apdata.ScreenUtil.cache.get("labelSeuPortal_lbl").update(Ext.apdata.lang.seuPortal);Ext.apdata.ScreenUtil.cache.get("labelPortalRH_lbl").update(Ext.apdata.lang.portalRH);document.title=Ext.apdata.lang.title;}
function translateOverhaul(){updateDate();Ext.apdata.ScreenUtil.cache.get("indexPage").hide();document.title=Ext.apdata.lang.title;Ext.apdata.ScreenUtil.cache.get("welcome_lbl").update(index.bemvindo);Ext.apdata.ScreenUtil.cache.get("txtSaudacao").update(index.saudacao);}
function checkBrowserCompatibility(){return false;if(!((Ext.isOpera)||(Ext.isChrome)||(Ext.isIE)||(Ext.isIE6)||(Ext.isIE7)||(Ext.isIE8)||(Ext.isGecko)||(Ext.isGecko2)||(Ext.isGecko3))){Ext.MessageBox.show({msg:Ext.apdata.lang.navegadorIncompativel,title:Ext.apdata.lang.atencao,animEl:"elId",icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK});}}
function setLanguageButtons(){var callBack=function(qtdeLangAtivas){if(qtdeLangAtivas>1&&!Ext.apdata.initialCfg.enableOverhaul){Ext.apdata.ScreenUtil.cache.get("idioms_lbl").setVisible(true);}}.createDelegate(this);Ext.apdata.util.languages.configureDisplayLanguageButtons(callBack,{portButton:"btBrasilInterno",USAButton:"btUSAInterno",espanholButton:"btEspanholInterno"});}
function getPublicLinks(){Ext.Ajax.request({url:Ext.apdata.getAction("GetPublicLinks"),success:function(response,options){var rst=Ext.decode(response.responseText);items=[];for(var i=0;rst.linkGroups[i];i++){items[i]={title:rst.linkGroups[i].linkGroup&&!Ext.isEmpty(rst.linkGroups[i].linkGroup)?rst.linkGroups[i].linkGroup:Ext.apdata.lang.semNome,html:publicLinksTpl.apply(rst.linkGroups[i]),headerCfg:{cls:"publicLink"}};}
var linksExternos=new Ext.Panel({layout:"accordion",applyTo:"extlnk",border:false,autoHeight:true,defaults:{autoHeight:true},items:(items===undefined||items.length<=0?undefined:items)});},failure:function(response,options){}});}
Ext.onReady(function(){function loadPage(){index=index();if(Ext.apdata.initialCfg.enableOverhaul==false||typeof Ext.apdata.initialCfg.enableOverhaul=="undefined"){Ext.apdata.ScreenUtil.cache.get("indexContainer").update(Ext.apdata.templates.get_indexOldTpl().apply());}
else{Ext.apdata.ScreenUtil.cache.get("indexContainer").update(Ext.apdata.templates.get_indexOverhaulTpl().apply({language:Ext.apdata.Session.language}));}
if(Ext.apdata.setMobile()){if(!Ext.apdata.initialCfg.enableOverhaul){Ext.apdata.util.showErrorMessage(Ext.apdata.lang.mobileDeactivated);}
else{var result=Ext.apdata.util.syncHTTPRequest(Ext.apdata.getAction("mobileReady"),{});if(!result||!result.success){Ext.apdata.util.showErrorMessage(Ext.apdata.lang.mobileDeactivated);return;}}}
if(!index.canChangePassword)
Ext.apdata.ScreenUtil.cache.get("trocarSenha").hide();if(index.canForgotPassword===false)
Ext.apdata.ScreenUtil.cache.get("esqueciSenha").hide();if(index.canLinks===false)
Ext.apdata.ScreenUtil.cache.get("cxLinks").hide();if(!Ext.apdata.lang.userTexts.bemvindo)
Ext.apdata.ScreenUtil.cache.get("welcome_lbl").hide();if(!Ext.apdata.initialCfg.enableOverhaul){translate();}
else{translateOverhaul();};clock();if(Ext.apdata.initialCfg.enableOverhaul){var lButtons={};lButtons.portButton='btBrasilInterno';lButtons.USAButton='btUSAInterno';lButtons.espanholButton='btEspanholInterno';Ext.apdata.util.languages.configureDisplayLanguageButtons(function(i){if(i==1){Ext.get('newLanguages').remove();}
else{if(!Ext.apdata.util.languages.activeLanguages.eng){Ext.get('btUSAInterno').remove();}
if(!Ext.apdata.util.languages.activeLanguages.esp){Ext.get('btEspanholInterno').remove();}
if(!Ext.apdata.util.languages.activeLanguages.port){Ext.get('btBrasilInterno').remove();}}},lButtons);Ext.get('newLanguages').on('change',function(){var l=Ext.get('newLanguages').dom[Ext.get('newLanguages').dom.selectedIndex].lang;Ext.apdata.util.setLanguage(l,false);},Ext.get('newLanguages'));}else{setLanguageButtons();}
if(Ext.apdata.util.windowsAuthentication){Ext.apdata.loginAuthenticOnserver=false;var URL=location.href;var pos=URL.indexOf('?');var paramsLocal=undefined;if(pos>=0){paramsLocal=Ext.urlDecode(URL.substr(pos+1));}
var byDirect=false;if(paramsLocal&&paramsLocal.ticket!==undefined){byDirect=true;}
Ext.apdata.paramsLocal=paramsLocal;Ext.apdata.ScreenUtil.cache.get("formHomeWinAuthentic").setDisplayed(true);Ext.apdata.ScreenUtil.cache.get("btLoginEntrar").dom.value=Ext.apdata.lang.entrarNoPortal;if(byDirect){Ext.apdata.ScreenUtil.cache.get("btLoginEntrarOutroUsuario").setDisplayed(false);}
else{Ext.apdata.ScreenUtil.cache.get("formHome").setDisplayed("none");Ext.apdata.ScreenUtil.cache.get("btLoginEntrarOutroUsuario").dom.value=Ext.apdata.lang.conectarOutroUsuario;}}
else{Ext.apdata.loginAuthenticOnserver=true;Ext.apdata.ScreenUtil.cache.get("formHomeWinAuthentic").setDisplayed("none");Ext.apdata.ScreenUtil.cache.get("formHome").setDisplayed(true);}
getPublicLinks();var columns=[{columnWidth:0.5,cls:"myClass",style:'padding: 10px 0 10px 0px'},{columnWidth:0.5,style:'padding:10px 0px 10px 0px'}];var items=[];if(index.assuntosGerais){Ext.each(index.assuntosGerais,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,issueId:item.assuntoGeral,tpl:item.template,height:item.altura,autoScroll:true,xtype:"apissueportlet",order:item.ordem});}});}
if(index.relogioVirtual){if(Ext.isArray(index.relogioVirtual)){Ext.each(index.relogioVirtual,function(item,idx,itemsRelogios){if(item.habilitado){items.push({title:item.titulo,deviceID:item.dispositivo,xtype:'relogiovirtual',tpl:relogioVirtualPortletTpl,onlyMarcacao:item.somenteMarcaoBtn,order:item.ordem,timeMessage:((item.tempoMensagem)?item.tempoMensagem:4)});}});}
else{if(index.relogioVirtual.habilitado){items.push({title:index.relogioVirtual.titulo,deviceID:index.relogioVirtual.dispositivo,xtype:'relogiovirtual',tpl:relogioVirtualPortletTpl,onlyMarcacao:index.relogioVirtual.somenteMarcaoBtn,order:index.relogioVirtual.ordem,timeMessage:((item.tempoMensagem)?item.tempoMensagem:4)});}}}
if(index.consultas){Ext.each(index.consultas,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,xtype:'appublicqueryportlet',limit:2000,height:item.altura,autoScroll:true,tpl:item.template,queryId:item.consulta,order:item.ordem,image:item.image});}});}
if(index.forecastSlider){Ext.each(index.forecastSlider,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,issueId:item.assuntoGeral,tpl:item.template,height:item.altura,autoScroll:false,xtype:"apforecastsliderportlet",images:item.images,order:item.ordem});}});}
if(index.pesquisaClima){Ext.each(index.pesquisaClima,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,xtype:'appublishesresearchportlet',height:item.altura,autoScroll:false,tpl:item.template,objectId:item.objectId,order:item.ordem});}});}
if(index.dadosExternos){Ext.each(index.dadosExternos,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,height:item.altura,html:dadosExternosTpl.apply({url:item.url}),order:item.ordem});}});}
if(index.exchangeRates){Ext.each(index.exchangeRates,function(item){if(item.habilitado===undefined||item.habilitado){items.push({title:item.titulo,height:item.altura,cls:"exchangePortlet",html:dadosExternosTpl.apply({url:item.url}),order:item.ordem});}});}
items.sort(function(a,b){return a.order-b.order;});Ext.each(items,function(item,index){if(index<Math.round(items.length/2)){if(!columns[0].items){columns[0].items=[];}
columns[0].items.push(item);}
else{if(!columns[1].items){columns[1].items=[];}
columns[1].items.push(item);}});var portletsArea=new Ext.ux.Portal({xtype:'portal',margins:'35 5 5 0',autoHeight:true,border:false,applyTo:"portletsHome",items:columns});var btLogin=Ext.apdata.ScreenUtil.cache.get("btLogin");loginFunc=function(){setCookie('loggedOut',true,-3600);var byDirect=false;if(Ext.apdata.paramsLocal&&Ext.apdata.paramsLocal.ticket!==undefined){byDirect=true;}
if(byDirect){if(Ext.apdata.paramsLocal&&Ext.apdata.paramsLocal.ticket!=="true"){setCookie("FIN_COOKIE",Ext.apdata.paramsLocal.ticket);}
Ext.Ajax.request({url:Ext.apdata.getAction("LoginByTicket"),params:{ticket:true},success:function(result){var rst=Ext.decode(result.responseText);if(document.documentURI){Ext.apply(rst,{initalURL:document.documentURI});}
else{Ext.apply(rst,{initalURL:document.URL});}
if(Ext.apdata.util.languages.activeLanguages){rst.languages={};Ext.apply(rst.languages,Ext.apdata.util.languages.activeLanguages);}
setCookie("dynSID",Ext.encode(rst));document.location="main.html";document.result=rst;},scope:this,failure:function(response,options){}});}
else{Ext.apdata.ScreenUtil.cache.get("indexPage").mask(Ext.apdata.lang.carregandoInformacoes);Ext.apdata.util.login(Ext.apdata.ScreenUtil.cache.get("username").getValue(),Ext.apdata.ScreenUtil.cache.get("password").getValue(),true,function(newPwd,success,result,isChangePassWord){if(isChangePassWord){Ext.apdata.util.login(Ext.apdata.ScreenUtil.cache.get("username").getValue(),newPwd,true);Ext.apdata.ScreenUtil.cache.get("username").dom.value="";Ext.apdata.ScreenUtil.cache.get("password").dom.value="";Ext.apdata.ScreenUtil.cache.get("indexPage").unmask();}},Ext.apdata.initialCfg&&Ext.apdata.initialCfg.urlRedirect?Ext.apdata.initialCfg.urlRedirect:document.URL,function(){Ext.apdata.ScreenUtil.cache.get("indexPage").unmask();}.createDelegate(this));}};btLogin.on("click",loginFunc);var btLoginDireto=Ext.apdata.ScreenUtil.cache.get("btLoginEntrar");btLoginDireto.on("click",loginFunc);trocarUsuario=function(){Ext.apdata.loginAuthenticOnserver=true;Ext.apdata.ScreenUtil.cache.get("formHomeWinAuthentic").dom.innerHTML='';Ext.apdata.ScreenUtil.cache.get("formHome").setDisplayed(true);Ext.apdata.ScreenUtil.cache.get("username").focus();Ext.apdata.util.NTLMLogin=false;};var btLoginOutroUsuario=Ext.apdata.ScreenUtil.cache.get("btLoginEntrarOutroUsuario");btLoginOutroUsuario.on("click",trocarUsuario);var btForgotPassword=Ext.apdata.ScreenUtil.cache.get("esqueciSenha");var btChangePassword=Ext.apdata.ScreenUtil.cache.get("trocarSenha");forgotPasswordFunc=function(){Ext.apdata.forgotPassword(Ext.apdata.ScreenUtil.cache.get("username").getValue(),Ext.apdata.ScreenUtil.cache.get("password").getValue(),"main.html",index.forgotPassScreenSize?index.forgotPassScreenSize.width:undefined,index.forgotPassScreenSize?index.forgotPassScreenSize.height:undefined);};changePasswordFunc=function(){if(Ext.apdata.ScreenUtil.cache.get("password").getValue().length==0){showErrorMessage(Ext.apdata.lang.usuarioESenhaVazioRV);}
else{Ext.apdata.util.changePassword(Ext.apdata.ScreenUtil.cache.get("username").getValue(),Ext.apdata.ScreenUtil.cache.get("password").getValue(),function(newPwd){Ext.apdata.util.login(Ext.apdata.ScreenUtil.cache.get("username").getValue(),newPwd,true);});}};btForgotPassword.on("click",forgotPasswordFunc);btChangePassword.on("click",changePasswordFunc);Ext.apdata.ScreenUtil.cache.get("password").addKeyMap({key:Ext.EventObject.ENTER,fn:loginFunc});Ext.apdata.ScreenUtil.cache.get("username").focus();var forgotPass=getCookie("forgotPass");if(forgotPass==="true"){setCookie("forgotPass",false);Ext.apdata.ScreenUtil.cache.get("username").dom.value=getCookie("username");setCookie("username","");forgotPasswordFunc();}
var byDirect=false;if(Ext.apdata.paramsLocal&&Ext.apdata.paramsLocal.ticket!==undefined){byDirect=true;}
if(byDirect&&Ext.apdata.paramsLocal&&Ext.apdata.paramsLocal.direct!==undefined){loginFunc();}
if(Ext.apdata.initialCfg.enableOverhaul==true){applyOverhaul();}else{Ext.apdata.ScreenUtil.cache.get("indexPage").show();}
if(Ext.apdata.isMobile){applyMobile();trocarUsuario();startMobileRenderedThreadForAndroid();};}
Ext.apdata.applyLanguageSelection(function(){Ext.apdata.util.verifyWindowsAuthentication(loadPage);}.createDelegate(this));});